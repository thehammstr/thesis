% !TEX root = ../Thesis.tex

\chapter{Introduction}
\label{ch.Introduction}
The work presented in this thesis enables the creation of full 3-D shape reconstructions of the submerged portion of free-drifting icebergs using data from autonomous underwater vehicles (AUVs). Accurate iceberg profiles or maps are useful in a number of scientific and industrial applications. They are normally acquired through the use of ship-based sonar or Remotely-Operated Vehicles (ROVs). However, AUVs are increasingly being used for this task, though current methods often make strong assumptions about the iceberg's motion, require the AUV to be constantly fed position updates from a ``tender" ship, or can only map incomplete portions of the iceberg at a time \cite{Kimball2011b}.

\begin{figure}[htbp]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/icebergs-shadow-350.jpg} % requires the graphicx package
   \caption{Antarctic tabular iceberg at sunset. \emph{www.mbari.org}}
   \label{fig:IcebergSunset}
\end{figure}

The creation of accurate maps using a robotic vehicle is equivalent to accurately determining the robot's trajectory through the space being mapped. Because the robot records its observations in its own local reference frame, the robot's position and orientation relative to the object being mapped must be determined in order to project those observations and create a self-consistent map of the world. Therefore, an accurate map and accurate trajectory estimation should be thought of as synonymous.

The primary challenge in the creation of maps of free-drifting icebergs is that the iceberg translates and rotates as the vehicle tries to map it. This motion makes the iceberg a non-inertial reference frame, which complicates trajectory estimation greatly. In above-water applications, rotating scanning lasers can image large portions of terrain almost instantaneously, and the resulting point clouds can be stitched together using scan matching techniques to provide accurate non-inertial odometry. Essentially, the data returned from these sensors has sufficient coverage to allow all components of the vehicle's motion relative to the terrain to be inferred by aligning the clouds. The sensing available to AUVs has a very limited field of view in the direction of travel, so successive measurements do not typically overlap. This makes it impossible to perform scan matching and directly infer the vehicle's terrain-relative velocity, so other methods must be used to correct for navigation errors induced by terrain motion. 

The strategy employed in this dissertation is to cast the iceberg mapping problem as a simultaneous localization and mapping (SLAM) problem. These methods of mapping use information within the environment being mapped to aid in trajectory estimation, hence the robot simultaneously creates a map and localizes itself within that map. The robot can gain information about its accumulated navigational error by revisiting portions of the terrain it has already traversed and using observed offsets to estimate and correct for those errors. 

One major challenge with performing SLAM in underwater environments is automatic detection of these so-called ``loop closure events." In shallow, feature-rich environments, such as coral reefs, cameras can be used, and robust image features can allow detection of these events. However, when standoff distances are large, or there is not sufficient texture in the terrain to allow image correlation, cameras provide little aid. In these cases, systems typically rely on accurate inertial guidance to provide a good initial estimate of regions of overlap, and then refine these estimates through point cloud correlation techniques like Iterative Closest Point (ICP). These methods can provide very accurate alignment, but are susceptible to local minima, and generally require good intial estimates of alignment to converge to the correct value. As noted above, when the environment is a non-inertial reference frame, even the most accurate inertial navigation system (INS) will not necessarily be able to provide sufficient accuracy for this type of loop closure detection. 

This dissertation presents several contributions: 

a) It provides a method for generating a self-consistent map of the \emph{entire} submerged portion of a free-drifting iceberg, including multiple swaths collected at different depths.

b) It formulates the mapping problem in such a way that the vehicle's inertial position need not be known, eliminating the need for external position fixes. This formulation also shows the equivalence between mapping in non-inertial environments and mapping with imperfect inertial sensors. 

c) It describes two tools for encoding loop closure information into the mapping process. The first is a graphical user interface with which a human user can detect these events. The second is a method for autonomous detection of loop closure events, drawing from well-developed work in the computer vision community.

d) It shows mapping results from simulation using shape data from a real iceberg, as well as results from AUV field data of an underwater canyon with simulated motion effects. In both cases, the algorithm is able to produce an accurate, self-consistent map of the body despite large odometry errors due to its motion.  



\section{Motivation}

\subsection{Life in extreme environments}

The underlying goal of the research presented in this dissertation is to develop techniques that enable the study of life in extreme environments. In particular, a number of preorganic molecular species thought to be necessary for life have been observed in high concentrations in comets and asteroids \cite{}. In fact, some theories hypothesize that these biological building blocks were first delivered to Earth via these objects impacting the planet several billion years ago \cite{}. Because of these and other reasons, asteroids and comets are scientific points of interest. Several recent missions have studied them, like NASA's Deep Impact \cite{} and ESA's Rosetta \cite{}, and NASA has begun considering future manned missions to study them \cite{}.

One challenge in the study of these celestial bodies is the lack of navigational infrastructure. There is no equivalent of GPS to supply a robotic vehicle with its position in the frame of reference of the body, and installing one on the surface would be exceedingly difficult. Star trackers and inertial guidance systems can be used, but these provide position of the vehicle in inertial space, not relative to the body \cite{}. In general, these bodies are free to rotate, making them non-inertial reference frames.

If a map of the body is available, terrain-relative navigation techniques can be used to localize relative to it, regardless of how it may be moving. Additionally, a map is a valuable scientific tool unto itself, allowing other data to be location-referenced and enabling longitudinal studies in the evolution of a body's shape. However, generating a map of a body that is moving relative to the inertial reference frame presents several challenges.

This dissertation deals with the analog mission of robotic exploration around a free-drifting iceberg, specifically the creation of a 3-dimensional map reconstruction of its underwater portion. While the mission is not a perfect analog to the comet or asteroid mission, both involve the study of life in extreme environments, a non-inertial reference frame, and navigation without installed infrastructure.  By conducting such real-world analog robotic exploration missions, lessons can be learned and risks can be mitigated before incurring the cost of launching hardware into space. 

\subsection{Iceberg shape reconstruction}

Accurate iceberg shape reconstructions have a number of uses, depending on the time scale of interest: immediate, days to weeks, and months to years. 

Energy companies operating in polar regions routinely hire contractors to do ship-based reconstructions of icebergs that pose a risk to their infrastructure. They use these reconstructions to help predict how the iceberg drift with the wind and ocean currents, and in high-fidelity collision simulations to asses the likelihood of damage in the even of impact with a drilling rig or pipeline \cite{ralph2008iceberg} \cite{fuglem1996iceberg}. Of particular importance in the latter case is knowing the depth and shape of the iceberg keel, as a keel dragging across the seafloor can cause catastrophic damage to pipelines. This is known as ``iceberg scour," and motivates the need for mapping the full depth of the iceberg.

Scientists who study iceberg ecology can also gain immediate benefit from iceberg reconstructions. Having a map of the iceberg allows them to ``geo-reference" their data in the frame of reference of the iceberg, providing much higher spatial resolution than offered by ship-based measurement alone.

In the days and weeks after their creation, iceberg reconstructions can be used to improve temporal resolution of data. Having geo-referenced data removes spatio-temporal ambiguity in data collected on different surveys, enabling an ``apples to apples" comparison over time. Additionally, iceberg maps can aid in return-to-site missions, where specific points of interest identified in an initial survey can be revisited. Armed with the map, the robot can perform terrain-relative navigation (TRN) to return to the site, even if the iceberg has drifted and rotated a considerable amount. This would grant scientists the opportunity to field tailored sensor suites, potentially giving a much clearer picture of what is happening in important areas.

Finally, on time scales of months to years, performing shape reconstruction on the same iceberg allows the calculation of an iceberg's melt rates and melt patterns.

\subsection{Advantages and Disadvantages of AUVs}

AUVs are an attractive alternative to ship-based methods of iceberg study. Typically, a ship will take an array of measurements at several points around an iceberg. Ships must maintain a large standoff distance when studying icebergs due to calving danger or the presence of brash ice, and may not be able to see the entire depth of the iceberg. Using a tethered ROV can allow closer approaches, but they maneuver slowly, and require the ship to constantly tend them when it might be used for other scientific purposes. Additionally, the tether can become severed or caught on brash ice.

AUVs address all of these concerns. They easily operate under brash ice, can approach closely without putting lives at risk, and do not require a tether. They provide high spatial resolution and can access the entire depth of the iceberg, while performing other scientific measurement, such as temperature, pressure, and salinity readings, or water sampling. 


\begin{figure}[htbp]
   \centering
   \includegraphics[width=0.7\textwidth]{../graphics/SimImage1.png} % requires the graphicx package
   \caption{The AUV has a multibeam sonar mounted on its left side. As it follows the contour of the iceberg reactively, it sweeps out a swath of sonar ranges. By spiraling downward over the course of the mapping run, the entire depth of the iceberg can be profiled.}
   \label{fig:simImage1}
\end{figure}


There are drawbacks, however: AUVs are limited in the size and power of the sensors they can carry, and can only collect limited volumes of water for later study, when compared to ships. Additionally, they often have limited maneuverability compared with ROVs, which can cause difficulty when operating around complex terrain or ice structure. Acoustic modems allow limited real-time communication with AUVs, but have very low bandwidth, requiring AUVs to be highly self-sufficient, and prohibiting immediate access to the data they collect. Because of this, AUVs will likely augment greatly, rather than completely replace ship-based surveys of icebergs for the foreseeable future. Working together, the surface vessels and underwater vehicles will provide more accurate reconstructions and a much clearer picture of the free-drifting iceberg environment than either method of study could alone.

\section{Mapping in underwater environments}

In order to resolve its body-fixed sensor readings into the reference frame of the world (or iceberg), the position and attitude of the robot with respect to the terrain must be determined. This combination of translation and rotation is also often referred to as the robot's \emph{pose}. If the robot's pose can be determined at each time a measurement was made, an accurate map can be generated. If the robot's pose is inaccurate, the resulting map will have warping and inconsistencies, which will vary depending on the source of the pose error. If it is not possible to measure directly the robot's pose, the pose must be estimated from available sensing. 

\begin{figure}[htbp]
   \centering
   \includegraphics[width=0.8\textwidth]{../graphics/AUVMapping.JPG} % requires the graphicx package
   \caption{Mapping AUVs typically carry downward-oriented multibeam sonars oriented to sweep over a wide swath of terrain as they move. They generally traverse large areas in a ``lawnmower pattern" and use overlapping observations to correct for any accumulated navigation drift in post-processing. \emph{www.mbari.org} }
   \label{fig:AUVbathyMapping}
\end{figure}

\subsection{Infrastructure-based localization}

Infrastructure-based localization works by employing equipment in the environment that can determine the position of a vehicle or provide sufficient information to the vehicle that it can determine its own position. GPS is currently the most well-known such system: a constellation of satellites provide GPS receivers with their own position and range information, which allows the receiver to infer its own position. Infrastructure-based systems can have one-way communication (like GPS) or two way communication, and many different principles of operation, but all methods are in some way \emph{cooperative} with the vehicle. 

GPS signals do not penetrate the ocean, so for infrastructure-based navigation underwater, two other methods are commonly used: Long-Baseline Interferometry (LBL) and Ultra-Short Baseline Interferometry (USBL). In LBL, an array of sonar beacons are deployed on the seafloor or other fixed structure, and surveyed for calibration. After that, the vehicle can use time-of-flight sonar signals to find its range to each, and calculate its position within the surveyed area. This is essentially the same principle of operation as GPS, but using sound waves instead of radio. In USBL, a ship-based transducer can calculate range and azimuth to the vehicle again based on sonar flight time, and using geometry and its own GPS-location, determine the robot's position. This method reduces in positional accuracy with increased distance from the ship. 

\begin{figure}[htbp]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/LBL.png} % requires the graphicx package
   \caption{Long-Baseline Interferometry provides position fixes to the vehicle, limiting drift. \emph{Graphic courtesy of Peter Kimball}}
   \label{fig:LBL}
\end{figure}

\subsection{Inertial navigation}

Inertial navigation is the use of self-contained highly-precise acceleration and angular rate measurements, integrated over time, to provide an estimate of pose. Though magnetometers do not, strictly speaking, provide inertial measurements, they are often also used to aid in attitude determination. This mode of navigation is often referred to as ``dead reckoning."

\begin{figure}[htbp]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/DeadReckoning.png} % requires the graphicx package
   \caption{Inertial navigation, or dead reckoning, requires no external infrastructure but will drift over time without bound. \emph{Graphic courtesy of Peter Kimball}}
   \label{fig:inertialNav}
\end{figure}

Any errors in the measurement or integration of these quantities will cause a drift in the estimated pose that will grow without bound over time. The growth rate of this drift can be decreased by either obtaining better measurements, or using measurements that will allow fewer integrations. For example, if a direct measurement of velocity can be obtained, only one integration must be performed to estimate position, generally yielding a slower drift rate than integrating accelerations twice. However, \emph{any} system that relies only on integrated measurements to provide an estimate of position \emph{will} drift over time, and the drift will be unbounded. 

\subsection{Environment-aided localization}

Environment-aided localization refers broadly to the use of information within the environment to prevent unbounded localization error. This differs from infrastructure-based methods in that it is assumed that the environment is not actively cooperating with the vehicle. The vehicle must use ``information of opportunity" to aid in its localization. 

\begin{figure}[htbp]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/TRN.png} % requires the graphicx package
   \caption{The vehicle can extract information from the terrain. If it traverses the same area more than once it can use the information to calculate an offset and eliminate any inertial drift that occurred between traversals. \emph{Graphic courtesy of Peter Kimball}}
   \label{fig:TRN}
\end{figure}

The type of environmental information used varies widely by application and available sensing, but the common thread is that if a vehicle can identify a landmark, feature, or area that it has traversed before, it can make a direct measurement of the magnitude and direction of drift it has accrued in the elapsed time, and account for that drift, bounding its magnitude in time. This has two parts: ``correspondence:" ior identifying these loop-closure events, and ``correlation:" estimating bias based on correspondence. 

In practice, nearly every mapping application uses some degree of environment-aided methods to achieve precise, self-consistent maps. In underwater mapping, self-intersecting trajectories are typically designed into a mission, and submaps from the beginning and end of the run are correlated to eliminate inertial drift. This technique is often referred to as ``scan matching" in the terrestrial robotics community, and is often used even when GPS is available to refine position estimates and produce maps of high precision. A similar strategy is used when creating mosaic images, such as aerial maps or panorama photos.  Keypoints, or distinctive image features, are extracted from each image and compared to keypoints from other images. After matches are identified ( solving the correspondence problem) the images are distorted to produce a self-consistent map, free of seams at the borders between images. The sensor modality is very different from a ranging sensor like sonar, but the principle is identical. 

Several types of environment-aided localization and mapping techniques will be described in Chapter \ref{ch.RelatedWork}.

\section{Challenges with mapping icebergs}

Mapping icebergs poses a set of unique challenges relative to other underwater mapping tasks. Specifically, they can move a substantial amount during the time it takes to image their entire surface. Icebergs are free to translate in two directions, and rotate in heading. They are pushed at random by the wind  and currents, making it difficult to predict how they will move. (Additionally, they are prone to flip or ``turtle," pitching 180 degrees over very short time scales, though this dissertation does not address such dynamic corner cases of mapping.) 

This motion has two major implications: first, it means that the iceberg constitutes a non-inertial reference frame. Unmodeled accelerations and rotations of the iceberg introduce large errors into the navigation solution, resulting in large apparent inertial drift rates and an inaccurate, inconsistent map. The sensors available to AUVs cannot account for this drift, or odometry error, driving the need to estimate the motion through other means. Second, the odometry error complicates greatly the task of data correspondence between traversals of the same area of the iceberg, a necessary step for using cues from the iceberg's geometry to estimate and account for its motion.

\begin{figure}[htbp]
   \centering
   \includegraphics[width=\textwidth]{../graphics/RawNavSim.png} % requires the graphicx package
   \caption{Iceberg translation and rotation causes large apparent navigational drift and unless corrected, results in map errors. The drift can be so severe that the correspondence problem cannot be solved using normal dead-reckoning methods.}
   \label{fig:naiveMapping}
\end{figure}

If the AUV were operating above water, powerful 3D laser scanners would allow a direct measurement of rotation and translation between measurements reducing or eliminating the errors associated to iceberg motion. This is shown in figure \ref{fig:ScanMatch}. These types of scanners can map and perform odometry simultaneously, and are often used on terrestrial robots and Unmanned Surface Vehicles, but do not work underwater \cite{Papadopoulos2014}. The multibeam sonars available to an AUV only scan in two dimensions. For mapping the iceberg, the sonar is oriented with the beam oriented perpindicular to the direction of travel in order to sweep out the widest area, as shown in Figure \ref{fig:beamOrientation}.  In order to perform scan matching for odometry, the sonar would need to be oriented in the horizontal plane, as in Figure \ref{fig:ScanMatchMultibeam}. This drives a need for environment-aided localization techniques, as described above. 

\begin{figure}[htbp]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/ScanMatch4a.png} % requires the graphicx package
   \caption{Top view of the iceberg mapping problem. If the sensor field of view has significant extent in the direction of travel, scan matching can provide odometry}
   \label{fig:ScanMatch1}
   \end{figure}
    \begin{figure}[h]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/ScanMatch4b.png} % requires the graphicx package
   \caption{Odometry corrected by scan matching. This readily extends to the full 3d case using techniques like Iterative Closest Point.}
   \label{fig:ScanMatch2}
\end{figure}

\begin{figure}[h]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/ScanMatch3.png} % requires the graphicx package
   \caption{Simulated AUV scans taken at two times, roughly 20 meters apart. The multibeam mapping sonar sweeps out a wide area when oriented perpendicular to the direction of travel. This orientation does not allow scan matching for odometry, since the beam pattern does not overlap from scan to scan, as shown in Figure \ref{fig:NoMatch}}
   \label{fig:beamOrientation}
\end{figure}

\begin{figure}[h]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/ScanMatch3a.png} % requires the graphicx package
   \caption{This shows the same plot as Figure \ref{fig:ScanMatch1}, but with a vertically-oriented multibeam sonar, as used in mapping, as opposed to a horizontally-mounted multibeam or 3D range scanner. This orientation does not allow scan matching for odometry, since the beam pattern does not overlap from scan to scan.}
   \label{fig:NoMatch}
\end{figure}

\begin{figure}[h]
   \centering
   \includegraphics[width=.8\textwidth]{../graphics/ScanMatch1.png} % requires the graphicx package
   \caption{A multibeam sonar could be used for odometry as in Figure \ref{fig:ScanMatch2} if mounted in the horizontal plane as shown, but only for trajectories at constant depth, as the field of view would be very narrow in the vertical direction. However, this configuration could only map a thin layer of the iceberg at a time, so it is unsuitable for the mapping mission.}
   \label{fig:ScanMatchMultibeam}
\end{figure}

To estimate and correct any inertial navigation drift that could yield inconsistencies in maps of underwater terrain, submaps from overlapping portions of a mission are correlated using point cloud alignment methods such as the Iterative Closest Point algorithm (ICP). This step produces an accumulated navigation error to high precision, but is nonconvex, and requires relatively good initial alignment to converge to the correct minimum. In normal underwater mapping tasks, the inertial navigation system yields a low enough drift rate that the vehicle is essentially guaranteed to be within a few meters of its estimate, which ensures that it will be initialized in the correct basin of attraction for the correlation step. 

The apparent inertial navigation drift due to iceberg motion can be so large that the robot's estimate of its position within the iceberg frame of reference can have very large errors. This can push the correlation method into a local minimum, yielding a false error vector, or it could mean that the two submaps do not correspond to the same patch of terrain at all! Either of these possibilities would result in potentially large map inconsistencies. This is called the \emph{correspondence problem,} and the iceberg motion makes it impossible to solve it in the typical manner of sufficiently accurate dead reckoning.   %The iceberg-motion-induced odometry error and the inability to directly account for it due to sensor limitations leads to the second implication: while iceberg motion requires environment-aided localization to estimate the errors due to motion, it complicates the correspondence problem, a crucial part of these techniques. This is because the standard method for solving the correspondence problem in underwater mapping relies on having well-characterized inertial navigation errors. Equipped with a high quality inertial navigation unit, a vehicle can fly a full mapping run and return on a self-intersecting trajectory to usually within meters of its true position. When it builds its submaps, it is essentially guaranteed to see the terrain it expects to see. The correspondence problem is simply solved by accurate dead reckoning. This is important, as the methods typically used for the correlation step are sensitive to initialization, and can fall into local minima or become intractible if too large a search area is used. 



In summary, the non-inertial iceberg reference frame will introduce large apparent errors in the vehicle's navigation, resulting in an inaccurate map. The vehicle can not typically directly measure the motion, driving a need for environment-aided techniques to estimate it. However, the motion also complicates the implementation of these techniques by making the data correspondence problem more difficult. 

\section{Contributions}

This dissertation makes four main contributions:

First, it provides a method for generating a self-consistent map of the \emph{entire} submerged portion of a free-drifting iceberg, including multiple swaths collected at different depths, using an AUV without the need for external monitoring or intervention. Previous methods had various limitations in the iceberg size, assumed the iceberg could not rotate, or had to be continuously sent positioning information from a surface vessel. The method presented can combine multiple swaths of data collected at different depths to build a map of the full submerged portion of the iceberg. 

Second, it formulates the mapping problem in such a way that the vehicle's inertial position need not be known, eliminating the need for external position fixes. This reformulation also shows the equivalence between mapping in non-inertial environments and mapping with imperfect inertial sensors, a well-studied problem in the robotics community. This allows the the map to be built efficiently by well-developed and highly-optimized algorithms.

Third, it presents several methods for autonomous detection of loop closure events. These methods use various means to reduce the size of the search space used to determing correspondence. In one method, application-specific information is leveraged to reduce the frequency of false matches. In the other, features inspired by the computer vision community are extracted and comapred using random sample consensus (RANSAC) to reduce  false positive correspondences.

Fourth, it presents successful mapping results, both from simulation and from field data. In the former, an iceberg model using shape data from a real iceberg is given simulated translational and rotational motion. The data is then fed to the SLAM algorithm and the error due to motion is eliminated. The field data consists of mapping an underwater canyon. This is shown for two cases: first on the raw inertial navigation data, which had developed a translational offset of \~ 5 meters over the course of the mapping run. Second, the compass data was corrupted to simulate the effects of a rotating iceberg, and the SLAM algorithm was allowed to recover from the large errors this incurred.

\section{Reader's guide}

\subsubsection*{Chapter \ref{ch.RelatedWork}: Related Work} A survey of methods currently used for iceberg profiling is presented, along with related work in Simultaneous Localization and Mapping, and methods for feature recognition and automatic loop closure detection.

\subsubsection*{Chapter \ref{ch.IcebergGeometry}: Iceberg Geometry}  This chapter recasts the optimization used by Kimball \cite{Kimball2011b} in the moving reference frame of the iceberg. This reduces greatly the number of estimation parameters, and eliminates the need for the vehicle to have knowledge of its inertial position.

\subsubsection*{Chapter \ref{ch.GraphSLAM}: Solving for Iceberg Shape using GraphSLAM} This section uses the problem formulation developed in Chapter \ref{ch.IcebergGeometry} and solves it using the GraphSLAM algorithm.

\subsubsection*{Chapter \ref{ch.LoopClosure}: Methods for loop closure detection} Limited sensing and moving terrain complicate the detection of loop closure events. This chapter lays out several methods to enable this capability.

\subsubsection*{Chapter \ref{ch.Results}: Mapping results} Results are presented on simulated data of a drifting iceberg, as well as field data collected in Monterey Canyon. 

\subsubsection*{Chapter \ref{ch.FutureWork}: Summary and Future Work}

